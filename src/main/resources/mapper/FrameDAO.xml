<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.recklessmo.dao.page.FrameDAO">
    <sql id="columns">
        id, name, url, time
    </sql>

    <sql id="byPageQuery">
        <if test="searchStr != null and '' != searchStr">
            <where>
                name like "%"#{searchStr}"%"
            </where>
        </if>
    </sql>

    <select id="listFrames" resultType="com.recklessmo.model.Page.Frame">
        select
        <include refid="columns"/>
        from frame
        <include refid="byPageQuery"/>
        order by time desc
        <if test="page != 0">
            limit #{startIndex}, #{count}
        </if>
    </select>

    <select id="listFramesCount" resultType="java.lang.Integer">
        select count(1) from img
        <include refid="byPageQuery"/>
    </select>

    <insert id="addFrame" parameterType="com.recklessmo.model.Page.Frame">
        insert into frame(name, url, time)
        values(#{name}, #{url}, #{time})
    </insert>

    <update id="deleteFrame">
        delete from frame where id = #{id} limit 1
    </update>

</mapper>